# Ux Concepts
# Auto-generated from semantics.py

[meta]
file = "ux"
concept_count = 7

[concepts.attention_signals]
category = "UX Semantic Layer (v0.2)"
definition = "Data-driven conditions that require user awareness or action. Signals have severity levels and can trigger actions."
syntax = '''
attention <critical|warning|notice|info>:
  when: <condition_expression>
  message: "<user-facing message>"
  [action: <surface_name>]
'''
example = '''
attention critical:
  when: due_date < today and status != done
  message: "Overdue task"
  action: task_edit

attention warning:
  when: priority = high and status = todo
  message: "High priority - needs assignment"
  action: task_assign
'''
related = ["ux_block", "conditions"]
v0_2_changes = "NEW in v0.2"
best_practices = ["✅ Use for data anomalies requiring action", "✅ Use for time-sensitive conditions", "❌ Don't use for purely visual styling", "❌ Don't overuse - reserve for truly important conditions"]

[concepts.defaults]
category = "UX Semantic Layer (v0.2)"
definition = "Default field values for a persona in create/edit forms. Pre-populates fields based on the user's role or context."
syntax = '''
ux:
  for <persona_name>:
    defaults:
      <field>: <value>
      <field>: current_user
      <field>: current_user.<attribute>
'''
example = '''
surface ticket_create "New Ticket":
  uses entity Ticket
  mode: create

  section main:
    field title
    field description
    field priority

  ux:
    purpose: "Create new support ticket"

    for customer:
      defaults:
        created_by: current_user
        status: open
        priority: medium

    for agent:
      defaults:
        created_by: current_user
        status: open
        assigned_to: current_user

surface order_create "New Order":
  uses entity Order
  mode: create

  ux:
    for sales_rep:
      defaults:
        created_by: current_user
        status: draft
        region: current_user.region
'''
related = ["persona", "ux_block", "surface"]
v0_2_changes = "NEW in v0.2"

[concepts.information_needs]
category = "UX Semantic Layer (v0.2)"
definition = "Specifications for how data should be displayed, sorted, filtered, and searched - the 'what' without the 'how'. On list surfaces these directives control the DataTable's interactive features."
syntax = '''
show: field1, field2, field3
sort: field1 desc, field2 asc
filter: status, category, assigned_to
search: title, description, tags
empty: "No items found. Create your first item."
'''
related = ["ux_block", "datatable"]
v0_2_changes = "NEW in v0.2"

[concepts.persona]
category = "UX Semantic Layer (v0.2)"
definition = "A role-based variant that adapts surfaces or workspaces for different user types without code duplication. Controls scope, visibility, and capabilities."
syntax = '''
for <persona_name>:
  scope: <filter_expression>
  purpose: "<persona-specific purpose>"
  [show: <field1>, <field2>, ...]
  [hide: <field1>, <field2>, ...]
  [show_aggregate: <metric1>, <metric2>, ...]
  [action_primary: <surface_name>]
  [read_only: true|false]
'''
example = '''
for admin:
  scope: all
  purpose: "Full user management"
  show_aggregate: total_users, active_count
  action_primary: user_create

for manager:
  scope: department = current_user.department
  purpose: "Manage department users"
  hide: salary, ssn
  action_primary: user_invite

for member:
  scope: id = current_user.id
  purpose: "View own profile"
  read_only: true
'''
related = ["ux_block", "scope", "workspace"]
v0_2_changes = "NEW in v0.2"
best_practices = ["✅ Use lowercase role names (admin, manager, member)", "✅ Base on roles or responsibilities", "❌ Avoid device-specific personas (mobile, desktop)", "❌ Avoid preference-based personas (dark-mode-user)"]

[concepts.purpose]
category = "UX Semantic Layer (v0.2)"
definition = "A single-line statement capturing the semantic intent of a surface or workspace - explaining WHY it exists."
syntax = "purpose: \"<single line explanation>\""
example = "purpose: \"Track customer support ticket resolution\""
related = ["ux_block"]
v0_2_changes = "NEW in v0.2"
best_practices = ["✅ Focus on user intent, not implementation", "✅ Answer 'why does this exist?'", "✅ Keep to one line", "❌ Avoid 'List of...' or 'CRUD for...'"]

[concepts.scope]
category = "UX Semantic Layer (v0.2)"
definition = "Filter expression defining what data a persona can see. Must be either 'all' or a comparison expression."
syntax = '''
scope: all
scope: <field> = current_user
scope: <field> = current_user.<attribute>
scope: <field> = <value>
scope: <expr1> and <expr2>
scope: <expr1> or <expr2>
'''
example = '''
# Full access for admins
for admin:
  scope: all

# Personal data - matches current user
for member:
  scope: owner_id = current_user

# Team-scoped data
for manager:
  scope: team_id = current_user.team_id

# Combined ownership - "my tasks"
for member:
  scope: assigned_to = current_user or created_by = current_user

# Status-filtered with ownership
for agent:
  scope: status = open and assigned_to = current_user
'''
related = ["persona", "conditions"]
v0_2_changes = "NEW in v0.2"
important_notes = ["'scope: all' is the only keyword - all other forms require a comparison expression", "Use 'field = current_user' for personal data (NOT 'scope: owned' or 'scope: personal')", "Combine with 'and'/'or' for complex expressions", "Field names must match entity field names exactly"]
common_mistakes = ["scope: owned  # INVALID - 'owned' is not a keyword", "scope: personal  # INVALID - use 'field = current_user'", "scope: mine  # INVALID - use 'field = current_user'", "scope: self  # INVALID - use 'id = current_user' or similar"]

[concepts.ux_block]
category = "UX Semantic Layer (v0.2)"
definition = "Optional metadata on surfaces and workspaces expressing WHY they exist and WHAT matters to users, without prescribing HOW to implement it."
syntax = '''
ux:
  purpose: "<semantic intent>"

  [show: <field1>, <field2>, ...]
  [sort: <field> [asc|desc], ...]
  [filter: <field1>, <field2>, ...]
  [search: <field1>, <field2>, ...]
  [empty: "<message>"]

  [attention <level>:]
    when: <condition>
    message: "<user message>"
    [action: <surface_name>]

  [for <persona>:]
    [scope: <filter_expression>]
    [purpose: "<persona purpose>"]
    [show: <fields>]
    [hide: <fields>]
    [show_aggregate: <metrics>]
    [action_primary: <surface>]
    [read_only: true|false]
'''
example = '''
ux:
  purpose: "Manage user accounts"

  sort: name asc
  filter: role, is_active
  search: name, email

  attention warning:
    when: days_since(last_login) > 90
    message: "Inactive account"

  for admin:
    scope: all
    action_primary: user_create

  for member:
    scope: id = current_user.id
    read_only: true
'''
related = ["purpose", "information_needs", "attention_signals", "persona", "datatable"]
v0_2_changes = "NEW in v0.2"

[concepts.datatable]
category = "Runtime Rendering"
definition = """
What the Dazzle runtime renders when a surface has mode: list. The base DataTable
always includes rows, action menu (View/Edit/Delete), pagination, and HTMX partial
updates. Adding sort/filter/search/empty directives in the ux: block enables
interactive features: clickable sort headers, filter dropdowns, debounced search,
column visibility toggle, and custom empty messages.
"""

syntax = '''
surface <name> "<Title>":
  uses entity <Entity>
  mode: list

  section main:
    field <field1> "<Label>"
    field <field2> "<Label>"

  ux:
    sort: <field> [asc|desc], ...
    filter: <enum_field>, <bool_field>, ...
    search: <text_field1>, <text_field2>, ...
    empty: "<message when no results>"
'''

example = '''
surface task_list "Tasks":
  uses entity Task
  mode: list

  section main:
    field title "Title"
    field status "Status"
    field priority "Priority"
    field due_date "Due"

  ux:
    sort: due_date asc
    filter: status, priority
    search: title, description
    empty: "No tasks yet. Create your first task!"

# Produces: sortable column headers, status + priority dropdown filters,
# debounced search input, column visibility toggle (>3 cols), custom empty message
'''

related = ["ux_block", "surface", "information_needs"]
best_practices = [
    "sort: pick the field users care about most (e.g. created_at desc for recent-first, name asc for alphabetical)",
    "filter: list enum, bool, and state machine fields — they render as dropdowns",
    "search: list text/string fields users would type into a search box",
    "empty: write a friendly message with a call to action (e.g. 'No tasks yet. Create your first task!')",
    "Every list surface should have a ux: block — the lint rule will warn if missing",
]
rendering_details = [
    "sort: All columns become clickable. Active column shows direction arrow. Click toggles asc/desc. State preserved across pagination.",
    "filter: enum/bool/state_machine → <select> dropdown with All option. text/other → debounced text input (300ms). Filters combine with AND logic.",
    "search: Debounced type-ahead (300ms). Clear button when text present. Targets listed fields. Combines with active filters and sort.",
    "empty: Custom message shown when no items match filters/search. Defaults to 'No items found.' if omitted.",
    "Column visibility: Toggle dropdown appears when >3 columns. Preferences persist in localStorage.",
]
