<div class="card bg-base-100 shadow-sm">
  <div class="card-body p-3">
    <h3 class="card-title text-sm">{{ title }}</h3>
    {% if item %}
    <dl class="grid grid-cols-2 gap-2">
      {% for col in columns %}
      <dt class="text-xs font-semibold opacity-60">{{ col.label }}</dt>
      <dd class="text-sm">
        {% if col.type == "badge" %}
          <span class="badge badge-sm {{ item[col.key] | badge_class }}">{{ item[col.key] | default("—") }}</span>
        {% elif col.type == "bool" %}
          {{ item[col.key] | bool_icon }}
        {% elif col.type == "date" %}
          {{ item[col.key] | dateformat }}
        {% elif col.type == "currency" %}
          {{ item[col.key] | currency }}
        {% elif col.type == "ref" %}
          {% set ref = item[col.key] %}
          {% if ref is mapping %}
            {% set ref_display = ref.get("name") or ref.get("company_name") or ((ref.get("first_name", "") ~ " " ~ ref.get("last_name", "")) | trim) or ref.get("title") or ref.get("label") or ref.get("email") or ref.get("id", "—") %}
            {% if col.ref_route and ref.get("id") %}
              <a href="{{ col.ref_route | replace('{id}', ref.id|string) }}" class="link link-hover link-primary">{{ ref_display }}</a>
            {% else %}{{ ref_display }}{% endif %}
          {% elif ref %}{{ ref }}{% else %}—{% endif %}
        {% else %}
          {{ item[col.key] | default("—") }}
        {% endif %}
      </dd>
      {% endfor %}
    </dl>
    {% else %}
    <p class="text-sm opacity-50">{{ empty_message | default("No record selected.") }}</p>
    {% endif %}
  </div>
</div>
