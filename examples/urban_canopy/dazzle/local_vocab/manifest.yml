version: 1.0.0
app_id: urban_canopy
dsl_core_version: 1.0.0

# Generic vocabulary for location-based, asset-tracking, and field service applications
# Useful for: urban planning, facilities management, equipment tracking, field inspections,
# volunteer coordination, member management, and any location/asset-centric app

entries:
  # ========================================================================
  # LOCATION PATTERNS - Geospatial and address fields
  # ========================================================================

  - id: geo_location_fields
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Geographic coordinates (latitude, longitude) for location tracking
    parameters:
      - name: lat_field
        type: string
        required: false
        default: location_lat
        description: Name of latitude field
      - name: lng_field
        type: string
        required: false
        default: location_lng
        description: Name of longitude field
      - name: required
        type: boolean
        required: false
        default: true
        description: Whether coordinates are required
    expansion:
      language: dazzle-core-dsl
      body: |
        {{ lat_field }}: decimal(9,6){% if required %} required{% endif %}
        {{ lng_field }}: decimal(9,6){% if required %} required{% endif %}
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - location
      - geospatial
      - coordinates
      - data
      - common

  - id: address_field
    kind: alias
    scope: data
    dsl_core_version: 1.0.0
    description: Physical street address field
    parameters:
      - name: field_name
        type: string
        required: false
        default: street_address
        description: Name of the address field
      - name: max_length
        type: number
        required: false
        default: 300
        description: Maximum address length
      - name: required
        type: boolean
        required: false
        default: false
        description: Whether address is required
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: str({{ max_length }}){% if required %} required{% endif %}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - location
      - address
      - data
      - common

  - id: full_location_fields
    kind: pattern
    scope: data
    dsl_core_version: 1.0.0
    description: Complete location tracking (coordinates + address)
    parameters:
      - name: coordinates_required
        type: boolean
        required: false
        default: true
        description: Whether lat/lng are required
      - name: address_required
        type: boolean
        required: false
        default: false
        description: Whether address is required
    expansion:
      language: dazzle-core-dsl
      body: |
        location_lat: decimal(9,6){% if coordinates_required %} required{% endif %}
        location_lng: decimal(9,6){% if coordinates_required %} required{% endif %}
        street_address: str(300){% if address_required %} required{% endif %}
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - location
      - geospatial
      - address
      - pattern
      - common

  # ========================================================================
  # ASSET TRACKING PATTERNS - For physical items/resources
  # ========================================================================

  - id: audit_fields
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Standard audit timestamp fields (created_at, updated_at)
    parameters: []
    expansion:
      language: dazzle-core-dsl
      body: |
        created_at: datetime auto_add
        updated_at: datetime auto_update
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - audit
      - timestamp
      - data
      - common

  - id: condition_status_enum
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Physical condition status field (Excellent, Good, Fair, Poor, Critical)
    parameters:
      - name: field_name
        type: string
        required: false
        default: condition_status
        description: Name of the condition field
      - name: default_value
        type: string
        required: false
        default: Good
        description: Default condition value
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: enum[Excellent,Good,Fair,Poor,Critical]={{ default_value }}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - condition
      - status
      - asset
      - data

  - id: inspection_tracking
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Last inspection date and inspector tracking
    parameters:
      - name: inspector_entity
        type: string
        required: false
        default: User
        description: Entity type for inspector (User, Volunteer, Inspector, etc.)
    expansion:
      language: dazzle-core-dsl
      body: |
        last_inspection_date: datetime optional
        last_inspector: ref {{ inspector_entity }}
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - inspection
      - tracking
      - audit
      - data

  # ========================================================================
  # MEDIA & DOCUMENTATION PATTERNS
  # ========================================================================

  - id: photo_url_field
    kind: alias
    scope: data
    dsl_core_version: 1.0.0
    description: URL field for photo/image attachments
    parameters:
      - name: field_name
        type: string
        required: false
        default: photo_url
        description: Name of the photo URL field
      - name: required
        type: boolean
        required: false
        default: false
        description: Whether photo is required
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: str(500){% if required %} required{% endif %}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - media
      - photo
      - attachment
      - data

  - id: document_url_field
    kind: alias
    scope: data
    dsl_core_version: 1.0.0
    description: URL field for document attachments
    parameters:
      - name: field_name
        type: string
        required: false
        default: document_url
        description: Name of the document URL field
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: str(500)"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - media
      - document
      - attachment
      - data

  - id: media_fields
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Multiple media attachment fields (photo_url, document_url)
    parameters: []
    expansion:
      language: dazzle-core-dsl
      body: |
        photo_url: str(500)
        document_url: str(500)
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - media
      - attachment
      - data

  # ========================================================================
  # TASK & ASSIGNMENT PATTERNS
  # ========================================================================

  - id: task_status_enum
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Generic task/work order status (Open, InProgress, Completed, Cancelled)
    parameters:
      - name: field_name
        type: string
        required: false
        default: status
        description: Name of the status field
      - name: default_value
        type: string
        required: false
        default: Open
        description: Default status value
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: enum[Open,InProgress,Completed,Cancelled]={{ default_value }}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - status
      - task
      - workflow
      - data
      - common

  - id: assignment_fields
    kind: macro
    scope: data
    dsl_core_version: 1.0.0
    description: Task assignment tracking (created_by, assigned_to)
    parameters:
      - name: user_entity
        type: string
        required: false
        default: User
        description: Entity type for users (User, Volunteer, Staff, etc.)
      - name: assignment_required
        type: boolean
        required: false
        default: false
        description: Whether assigned_to is required
    expansion:
      language: dazzle-core-dsl
      body: |
        created_by: ref {{ user_entity }} required
        assigned_to: ref {{ user_entity }}{% if assignment_required %} required{% endif %}
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - assignment
      - task
      - tracking
      - data
      - common

  # ========================================================================
  # MEMBER/VOLUNTEER PATTERNS
  # ========================================================================

  - id: active_status_field
    kind: alias
    scope: data
    dsl_core_version: 1.0.0
    description: Active/inactive boolean flag for members, volunteers, or resources
    parameters:
      - name: field_name
        type: string
        required: false
        default: is_active
        description: Name of the active status field
      - name: default_value
        type: boolean
        required: false
        default: true
        description: Default active status
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: bool{% if default_value %}=true{% else %}=false{% endif %}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - status
      - member
      - volunteer
      - data

  - id: joined_at_field
    kind: alias
    scope: data
    dsl_core_version: 1.0.0
    description: Timestamp when member/volunteer joined
    parameters:
      - name: field_name
        type: string
        required: false
        default: joined_at
        description: Name of the join timestamp field
    expansion:
      language: dazzle-core-dsl
      body: "{{ field_name }}: datetime auto_add"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - timestamp
      - member
      - volunteer
      - data

  # ========================================================================
  # OBSERVATION/LOG ENTRY PATTERNS
  # ========================================================================

  - id: observation_entity
    kind: pattern
    scope: data
    dsl_core_version: 1.0.0
    description: Generic observation/log entry template for recording inspections or notes
    parameters:
      - name: entity_name
        type: string
        required: false
        default: Observation
        description: Name of the observation entity
      - name: subject_entity
        type: string
        required: true
        description: Entity being observed (Tree, Asset, Equipment, etc.)
      - name: subject_field
        type: string
        required: false
        default: subject
        description: Field name for subject reference
      - name: observer_entity
        type: string
        required: false
        default: User
        description: Entity type for observer
    expansion:
      language: dazzle-core-dsl
      body: |
        entity {{ entity_name }} "{{ entity_name }}":
          id: uuid pk
          {{ subject_field }}: ref {{ subject_entity }} required
          observer: ref {{ observer_entity }} required
          notes: text
          photo_url: str(500)
          submitted_at: datetime auto_add
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - entity
      - observation
      - log
      - inspection
      - pattern

  # ========================================================================
  # UI PATTERNS
  # ========================================================================

  - id: crud_surface_set
    kind: pattern
    scope: ui
    dsl_core_version: 1.0.0
    description: Complete CRUD surface set (list, view, create, edit)
    parameters:
      - name: entity_name
        type: string
        required: true
        description: Name of the entity
      - name: title_field
        type: string
        required: true
        description: Primary display field
    expansion:
      language: dazzle-core-dsl
      body: |
        surface {{ entity_name | lower }}_list "{{ entity_name }} List":
          uses entity {{ entity_name }}
          mode: list

          section main "{{ entity_name }}s":
            field {{ title_field }} "{{ title_field | title }}"

        surface {{ entity_name | lower }}_detail "{{ entity_name }} Detail":
          uses entity {{ entity_name }}
          mode: view

          section main "{{ entity_name }} Details":
            field {{ title_field }} "{{ title_field | title }}"

        surface {{ entity_name | lower }}_create "Create {{ entity_name }}":
          uses entity {{ entity_name }}
          mode: create

          section main "New {{ entity_name }}":
            field {{ title_field }} "{{ title_field | title }}"

        surface {{ entity_name | lower }}_edit "Edit {{ entity_name }}":
          uses entity {{ entity_name }}
          mode: edit

          section main "Edit {{ entity_name }}":
            field {{ title_field }} "{{ title_field | title }}"
    metadata:
      stability: stable
      source: agent
      created_at: "2025-11-23T00:00:00Z"
      usage_count: 0
    tags:
      - crud
      - ui
      - pattern
      - common
